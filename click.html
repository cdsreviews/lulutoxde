<script>
    (function () {
        const urlParams = new URLSearchParams(window.location.search);

        // 从 URL 或 localStorage 获取参数，若都没有则用 "0"
        const gclid = urlParams.get('gclid') || localStorage.getItem('gclid') || '0';
        const fbclid = urlParams.get('fbclid') || localStorage.getItem('fbclid') || '0';
        const utmTerm = urlParams.get('utm_term') || localStorage.getItem('utm_term') || '0';

        // 保存当前参数到 localStorage
        localStorage.setItem('gclid', gclid);
        localStorage.setItem('fbclid', fbclid);
        localStorage.setItem('utm_term', utmTerm);

        // 构建跳转 URL
        const baseUrl = 'https://nmttrack.com/';
        const params = new URLSearchParams({
            a: '146518',
            c: '407790',
            co: '194328',
            mt: '19',
            s1: 'FB',
            s2: 'XHD',
            s3: 'AW-17028711680/YkwnCLnF-74aEICK9rc_',
            s4: 'lulutoxde.vercel.app',
            s5: gclid !== '0' ? gclid : fbclid !== '0' ? fbclid : '0',
            utm_term: utmTerm
        });

        // 最终跳转地址
        const redirectUrl = baseUrl + '?' + params.toString();

        // 避免重复跳转
        if (!window.location.href.includes('nmttrack.com')) {
            window.location.href = redirectUrl;
        }
    })();
</script>
